function BeatPicker(e){var t={};$.extend(true,t,this,e);$.extend(this,t);this.constructor()}BeatPicker.prototype={dateInputNode:null,pickerNode:null,locale:"en",daysSimple:["Su","Mo","Tu","We","Th","Fr","Sa"],daysSimple_es:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],daysFull:[],monthsSimple:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsSimple_es:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsFull_es:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],startDate:new Date,currentDate:new Date,dateFormat:{separator:"-",format:["YYYY","MM","DD"]},modules:{header:true,footer:true,daysOfTheWeek:true,navBar:true,today:true,gotoDate:true,icon:false,clear:false},selectionRule:{single:true,range:false,rangeDisableSelect:false},className:{beatPicker:"beatpicker",header:"header",footer:"footer",days:"days",inputParent:"input-parent",headerNavBarParent:"header-navbar-container",headerNavBarButton:"header-navbar-button",weekDaysAliasCell:"week-alias-cell",weekDaysAliasCellParent:"week-alias-cell-parent",input:"beatpicker-input",inputTo:"beatpicker-input-to",betweenRange:"between-range",inputFrom:"beatpicker-input-from",daysCell:"days-cell",monthsCell:"months-cell",yearsCell:"years-cell",yearsRangeCell:"years-range-cell",daysCellParent:"days-cell-parent",todayButton:"today",todayBox:"today-box",gotoDateParent:"goto-date-parent",gotoDateInput:"goto-date",gotoDateButton:"goto-date-button",selected:"selected",disabled:"disabled",clear:"beatpicker-clear",_inner:{beatPicker:"beatpicker",inputContainer:"input-container",cell:"cell",cellM:"cell-months",cellY:"cell-years",cellYR:"cell-years-range",cellParent:"cell-parent",headerNavBar:"main-nav",headerNavBarBtn:"nav-btn",headerNavBarBtnNext:"next",headerNavBarBtnPrev:"prev",inputNode:"beatpicker-inputnode",dateInputTo:"beatpicker-inputnode-to",betweenDateNode:"between-range",dateInputFrom:"beatpicker-inputnode-from",headerNavBarBtnMonthIndicator:"current-indicator",notNotable:"not-notable",todayButton:"today",gotoDateInput:"date-input",gotoDateButton:"date-input-button",gotoDateContainer:"goto-date-container",footer:"footer",todayInGrid:"notable-today",selectedDate:"selected-date",disableDate:"date-disabled",clearButton:"beatpicker-clearButton",defaultButton:"button"}},view:{display:"days",alwaysVisible:false,position:["bottom","left"],showOn:"click",hideOn:"click",isInputIsReadonly:true,iconImage:""},labels:{today:"Today",gotoDateInput:"YYYY/MM/DD",gotoDateButton:"GO",clearButton:"Clear"},labels_es:{today:"Hoy",gotoDateInput:"YYYY/MM/DD",gotoDateButton:"Ir",clearButton:"Limpiar"},events:{select:"select",change:"change",show:"show",hide:"hide",clear:"clear"},disablingRules:[],_inputParentNode:null,_dateInputToNode:null,_dateRows:[],_monthsRows:[],_yearsRows:[],_yearsRangeRows:[],_monthUnit:"MM",_yearUnit:"YYYY",_dayUnit:"DD",_todayNode:null,_calendarMainNode:null,_selectedDateNode:null,_selectedDate:null,_startRangeSelectedDate:null,_startRangeSelectedDateBk:null,_startRangeSelectedNode:null,_endRangeSelectedDate:null,_endRangeSelectedDateBk:null,_endRangeSelectedNode:null,_isFromDateOpened:false,_isToDateOpened:false,_isHide:true,_disableDateMap:[],_displaySet:{days:"days",months:"months",years:"years"},_briefDateScope:{briefDate:"BRIEFDATE",yearName:"YEARNAME",yearsRange:"YEARSRANGE"},_rulesCharacterSet:{"<":"<",">":">","*":"*"},_topicMap:{},constructor:function(){!window.beatPickerList&&(window.beatPickerList=[]);window.beatPickerList.push(this);this.daysSimple=this.locale==="es"?this.daysSimple_es:this.daysSimple;this.monthsSimple=this.locale==="es"?this.monthsSimple_es:this.monthsSimple;this.monthsFull=this.locale==="es"?this.monthsFull_es:this.monthsFull;this.labels=this.locale==="es"?this.labels_es:this.labels;this._enhanceLibFunctions();this._setStartDate(this.startDate);this._disablingRuleEngine();this._prepareInput();var e=this._calendarMainNode=this.pickerNode=this._baseDom();this._eventAndPositioning();if(this.modules.header){var t=this._createHeader();e.prepend(t)}if(this.modules.navBar&&t)e.append(this._createNavBar(t));e.append(this._createDateMatrices());if(this.modules.footer){var n=this._createFooter();e.append(n)}if(this.modules.footer&&this.modules.today)this._createToday(n);if(this.modules.footer&&this.modules.gotoDate)this._createGotoDate(n);if(this.modules.icon)this._createIcon();if(this.modules.clear)this._createClear();this._getDecisionOnEvents();this.view.alwaysVisible&&this.show()},_setStartDate:function(e){if(typeof e==="string")this.startDate=new Date(e);else if(e instanceof Array)this.startDate=new Date(this.startDate[0],this.startDate[1]-1,this.startDate[2]);else if(e instanceof Object)this.startDate=e;this.currentDate=this.startDate},_prepareInput:function(){this.dateInputNode.after(this._inputParentNode=this._domGenerator("div",{"class":this._addClass(this.className.inputParent,this.className._inner.inputContainer)}));this.dateInputNode.appendTo(this._inputParentNode).addClass(this._addClass(this.className.input,this.className._inner.inputNode));this.selectionRule.range&&this.dateInputNode.addClass(this._addClass(this.className.inputFrom,this.className._inner.dateInputFrom)).after(this._dateInputToNode=this._domGenerator("input",{type:"text","class":this._addClass(this.className.inputTo,this.className._inner.dateInputTo,this.className.input,this.className._inner.inputNode)},this._inputParentNode));this.view.isInputIsReadonly&&this.dateInputNode.add(this.selectionRule.range?this._dateInputToNode:{}).attr("readonly",true)},_baseDom:function(){return this._domGenerator("div",{"class":this._addClass(this.className.beatPicker,this.className._inner.beatPicker)},this.view.alwaysVisible?this._inputParentNode:$("body"))},_createClear:function(){var e=this;var t=this._domGenerator("button",{"class":this._addClass(this.className.clear,this.className._inner.clearButton,this.className._inner.defaultButton)},null,this.labels.clearButton);t.on("click",function(){if(e._selectedDate||e._startRangeSelectedDate||e._endRangeSelectedDate){var t={timeStamp:(new Date).getTime()};if(e.selectionRule.range)$.extend(t,{startDate:e._startRangeSelectedDate,startDateString:e._startRangeSelectedDate?e._dateFormatting(e._startRangeSelectedDate):null,endDate:e._endRangeSelectedDate,endDateString:e._endRangeSelectedDate?e._dateFormatting(e._endRangeSelectedDate):null});else if(e.selectionRule.single)$.extend(t,{date:e._selectedDate,string:e._dateFormatting(e._selectedDate)});e._notifySubscribers(e.events.clear,t);e.reset()}});this._inputParentNode.append(t)},_createIcon:function(){this.dateInputNode.add(this._dateInputToNode).css("background-image","url('"+this.view.iconImage+"')")},_createNavBar:function(e){var t=this;var n=this._domGenerator("div",{"class":this._addClass(this.className.headerNavBarParent,this.className._inner.headerNavBar)},e,"",true);this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnNext,this.className._inner.defaultButton)},n,">").on("click",function(){t._increaseUnity(false)});var r=this._currentIndicator=this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnMonthIndicator,this.className._inner.defaultButton)},n).on("click",function(){t._ExpandOrCollapse(true)});this._currentBriefDateSet(r,this._briefDateScope.briefDate);this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnPrev,this.className._inner.defaultButton)},n,"<").on("click",function(e){t._increaseUnity(true)})},_createHeader:function(){var e=this._domGenerator("div",{"class":this.className.header});this.modules.daysOfTheWeek&&e.append(this._createDaysOfTheWeek(this.daysSimple));return e},_createDaysOfTheWeek:function(e){if(e instanceof Array){var t=this._weekDayParent=this._domGenerator("ul",{"class":this.className.weekDaysAliasCellParent+" "+this.className._inner.cellParent});this.forEach(e,function(e,n){this._domGenerator("li",{"class":this.className.weekDaysAliasCell+" "+this.className._inner.cell},t,n)},this);return t}},_createFooter:function(){return this._footerNode=this._domGenerator("div",{"class":this._addClass(this.className.footer,this.className._inner.footer)})},_createToday:function(e){var t=this;this._domGenerator("a",{"class":this._addClass(this.className.todayButton,this.className._inner.todayButton,this.className._inner.defaultButton)},e,this.labels.today).on("click",function(e){t.currentDate=new Date;t._updateDateMatricesExactDate(t.currentDate)})},_createGotoDate:function(e){var t=this;var n=this._domGenerator("div",{"class":this._addClass(this.className.gotoDateParent,this.className._inner.gotoDateContainer)},e);var r=this._domGenerator("input",{type:"text","class":this._addClass(this.className.gotoDateInput,this.className._inner.gotoDateInput),placeholder:this.labels.gotoDateInput},n).on("keydown",function(e){if(e.keyCode===13)t._jumpToDateFromInput(r)});this._domGenerator("a",{type:"button","class":this._addClass(this.className.gotoDateButton,this.className._inner.gotoDateButton,this.className._inner.defaultButton)},n,this.labels.gotoDateButton).on("click",function(){t._jumpToDateFromInput(r)})},_createDateMatrices:function(){var e=this;this._notifySubscribers(this.events.change,{date:this.currentDate,timeStamp:(new Date).getTime()});if(!this._daysBody){var t=this._daysBody=this._domGenerator("div",{"class":this.className.days})}this._daysCellParent&&this._daysCellParent.empty();this._dateRows.length=this._monthsRows.length=this._yearsRows.length=0;if(!this._daysCellParent)var n=this._daysCellParent=this._domGenerator("ul",{"class":this.className.daysCellParent+" "+this.className._inner.cellParent},this._daysBody);if(this.view.display===this._displaySet.days){this._weekDayParent&&this._weekDayParent.show();this._daysBody.find(n).empty();for(var r=0;r<42;r++){var i=this._domGenerator("li",{"class":this.className.daysCell+" "+this.className._inner.cell},this._daysCellParent);this._dateRows.push(i);var s=this._bindDateToRows(r,i);i.data("click-behaviour",s.isNextMonth);i.on("click",function(t){var n=$(this).data("click-behaviour");var r=$(this).data("disabled");!r&&e._dateSelect(t);n!=="not-avail"&&e._updateDateMatrices(n?1:-1,e._monthUnit)});i.text(s.day);this.selectionRule.single&&this._findSelectedDate(this._dateRows[r].data("date"),this._dateRows[r])}this._markToday(new Date);if(this.selectionRule.range)this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate)}else{if(this.view.display===this._displaySet.months){this._createMonths();this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearName)}else if(this.view.display===this._displaySet.years){this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearsRange);this._createYears()}}return t},_createMonths:function(){var e=this;this._weekDayParent&&this._weekDayParent.hide();for(var t=0;t<=11;t++){var n=this._domGenerator("li",{"class":this._addClass(this.className.monthsCell,this.className._inner.cell,this.className._inner.cellM)},this._daysCellParent,this.monthsSimple[t]).on("click",function(){e.view.display=e._displaySet.months;e._ExpandOrCollapse(false,$(this).data("date"))});this._monthsRows.push(n);n.data("date",this._setAppropriateDate(t,true))}},_createYears:function(){var e=this;this._weekDayParent&&this._weekDayParent.hide();var t=this._getYearsRange(this.currentDate.getFullYear());for(var n=0;n<=11;n++){var r=this._domGenerator("li",{"class":this._addClass(this.className.yearsCell,this.className._inner.cell,this.className._inner.cellY)},this._daysCellParent,t[n]).on("click",function(){e.view.display=e._displaySet.years;e._ExpandOrCollapse(false,$(this).data("date"))});this._yearsRows.push(r);r.data("date",this._setAppropriateDate(t[n],false))}},_updateMonths:function(){for(var e in this._monthsRows){this._monthsRows[e].data("date",this._setAppropriateDate(e,true))}},_updateYears:function(){var e=this._getYearsRange(this.currentDate.getFullYear());for(var t in this._yearsRows){this._yearsRows[t].data("date",this._setAppropriateDate(e[t],false));this._yearsRows[t].text("").text(e[t])}},_eventAndPositioning:function(){var e=this;if(!this.view.alwaysVisible){e._calendarMainNode.css("display","none");$("html,body").on(this.view.hideOn,function(t){!e._isHide&&e.hide()});this._calendarMainNode.on("click",function(e){e.stopPropagation()})}var t=this.dateInputNode;this.selectionRule.range&&(t=this.dateInputNode.add(this._dateInputToNode));t.on(this.view.showOn,function(t){t.stopPropagation();if(e._isHide||e.selectionRule.range){var n=$.grep(window.beatPickerList,function(t,n){return t!==e&&!t.view.alwaysVisible});e.forEach(n,function(e,t){!t.isHide()&&t.hide()},e);e.show(t)}})},_positionThisNodePlease:function(e,t){var n=this._positionCalculation(e,t);this._calendarMainNode.css({left:n.x,top:n.y})},_positionCalculation:function(e,t){var n=this._dynamicsGeometry(e);var r=t&&t.x||this.view.position[0];var i=t&&t.y||this.view.position[1];var s=this;var o={rightTop:function(){r=this._rightCommon();i=this._topCommon()-s._calendarMainNode.outerHeight()},rightMiddle:function(){r=this._rightCommon();i=this._topCommon()-s._calendarMainNode.outerHeight()/2+s.dateInputNode.outerHeight()/2},rightBottom:function(){r=this._rightCommon();i=this._topCommon()},leftTop:function(){r=this._leftCommon();i=this._topCommon()-s._calendarMainNode.outerHeight()},leftMiddle:function(){r=this._leftCommon();i=this._topCommon()-s._calendarMainNode.outerHeight()/2+s.dateInputNode.outerHeight()/2},leftBottom:function(){r=this._leftCommon();i=this._topCommon()},bottomRight:function(){i=this._bottomCommon();r=this._rightCommon()-s._calendarMainNode.outerWidth()},bottomMiddle:function(){i=this._bottomCommon();r=this._leftCommon()+n.width/2+s._calendarMainNode.width()/2},bottomLeft:function(){i=this._bottomCommon();r=this._leftCommon()+s._calendarMainNode.outerWidth()},topRight:function(){i=this._topCommon()-s._calendarMainNode.outerHeight();r=this._rightCommon()-s._calendarMainNode.outerWidth()},topMiddle:function(){i=this._topCommon()-s._calendarMainNode.outerHeight();r=this._leftCommon()+n.width/2+s._calendarMainNode.width()/2},topLeft:function(){i=this._topCommon()-s._calendarMainNode.outerHeight();r=this._leftCommon()+s._calendarMainNode.outerWidth()},left:function(){r=this._leftCommon();i=this._topAutoCommon()},top:function(){i=this._topCommon()-s._calendarMainNode.outerHeight();r=this._leftAutoCommon()},right:function(){r=this._rightCommon();i=this._topAutoCommon()},bottom:function(){i=this._bottomCommon();r=this._leftAutoCommon()},"**":function(){i=this._topAutoCommon();r=this._leftAutoCommon()},customAdjustment:function(){i=n.y+ +i;r=n.x+ +r},_rightCommon:function(){return n.x+n.width},_bottomCommon:function(){return n.y+n.height},_leftCommon:function(){return n.x-s._calendarMainNode.outerWidth()},_topCommon:function(){return n.y},_topAutoCommon:function(){var e;if(+(this._topCommon()+s._calendarMainNode.outerHeight()-$(window).scrollTop())>$(window).height()){e=$(window).height()+$(window).scrollTop()-s._calendarMainNode.outerHeight();if($(window).height()<s._calendarMainNode.outerHeight())e=$(window).scrollTop()}else e=this._topCommon();return Math.floor(e)},_leftAutoCommon:function(){var e;var t=this._leftCommon()+s._calendarMainNode.outerWidth();if(t+s._calendarMainNode.outerWidth()>$(window).width()){e=$(window).width()-s._calendarMainNode.outerWidth();if(e<=0)e=$(window).scrollLeft()}else e=t;return Math.floor(e)}};if(isNaN(r)&&isNaN(i)){var u=r;var a=i.substr(0,1).toUpperCase()+this.view.position[1].substr(1);var f=r==="*"&&i==="*"?"**":i=="*"?u:u+a;if(f==="**"&&this.view.alwaysVisible)f="bottomLeft";f in o&&o[f]()}else if(!isNaN(r)&&!isNaN(i)){o.customAdjustment()}return{y:i,x:r}},_dateSelect:function(e){var t=$(e.originalEvent.currentTarget);var n=t.data("date");var r=this._dateFormatting(n);var i={};if(this.selectionRule.single){this._selectedDateNode&&this._removeClassFromSelectedDate(this._selectedDateNode);this._selectedDate=new Date(n.getTime());this.dateInputNode.val(r);this._selectedDateNode=t;!this.view.alwaysVisible&&this.hide();this._addClassToSelectedDate(this._selectedDateNode);i={dateObj:n,string:r,timeStamp:(new Date).getDate()};this._notifySubscribers(this.events.select,i)}else if(this.selectionRule.range){if(this._isFromDateOpened){this._startRangeSelectedDateBk=n;this._resetRules(true)}else if(this._isToDateOpened){this._endRangeSelectedDateBk=n;this._resetRules(false)}if(this.selectionRule.rangeDisableSelect||!this._checkForRangeDisable(this._startRangeSelectedDateBk,this._endRangeSelectedDateBk,this._isFromDateOpened)){i={fromDate:this._startRangeSelectedDate,toDate:this._endRangeSelectedDate,timeStamp:(new Date).getTime()};if(this._isFromDateOpened){this._startRangeSelectedNode&&this._removeClassFromSelectedDate(this._startRangeSelectedNode);this._startRangeSelectedNode=t;this._startRangeSelectedDate=this._startRangeSelectedDateBk=n;$.extend(i,{fromDate:this._startRangeSelectedDate});this._notifySubscribers(this.events.select,i);this.dateInputNode.val(r);this.show({currentTarget:this._dateInputToNode[0]})}else if(this._isToDateOpened){this._endRangeSelectedNode&&this._removeClassFromSelectedDate(this._endRangeSelectedNode);this._endRangeSelectedNode=t;this._endRangeSelectedDate=this._endRangeSelectedDateBk=n;$.extend(i,{toDate:this._endRangeSelectedDate});this._notifySubscribers(this.events.select,i);this._dateInputToNode.val(r);this._closeIfFill()&&!this._startRangeSelectedDate&&this.show(this.dateInputNode)}this._addClassToSelectedDate(t);this._startRangeSelectedDate&&this._endRangeSelectedDate&&this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate)}else{this._endRangeSelectedDateBk=this._endRangeSelectedDate?new Date(this._endRangeSelectedDate.getTime()):null;this._startRangeSelectedDateBk=this._startRangeSelectedDate?new Date(this._startRangeSelectedDate.getTime()):null}}},_currentBriefDateSet:function(e,t){if(e){if(t===this._briefDateScope.briefDate)(e||this._currentIndicator)["text"](this.monthsFull[this.currentDate.getMonth()]+" "+this.currentDate.getFullYear());else if(t===this._briefDateScope.yearName)(e||this._currentIndicator)["text"](this.currentDate.getFullYear());else if(t===this._briefDateScope.yearsRange){var n=this._getYearsRange(this.currentDate.getFullYear());(e||this._currentIndicator)["text"](n[0]+"-"+n[n.length-1])}}},_updateDateMatrices:function(e,t,n){var r={YYYY:"FullYear",MM:"Month",DD:"Date"};var i=this.currentDate["get"+r[t]]();var s=new Date(this.currentDate.getTime());if(this.currentDate.getDate()===31&&t===this._monthUnit)this.currentDate.setDate(28);this.currentDate["set"+r[t]](i+e);if(this.currentDate.getFullYear()>=0)this._updateDateMatricesCommon(n);else this.currentDate=new Date(s.getTime())},_updateDateMatricesExactDate:function(e,t,n){this.currentDate=new Date(e.getTime());this._updateDateMatricesCommon(n)},_updateDateMatricesCommon:function(e){!e&&this._notifySubscribers(this.events.change,{date:this.currentDate,string:this._dateFormatting(this.currentDate),timeStamp:(new Date).getTime()});if(this.view.display===this._displaySet.days){this._selectedDateNode&&this._removeClassFromSelectedDate(this._selectedDateNode);if(this.selectionRule.range){if(this._isFromDateOpened)this._endRangeSelectedDate&&this._disableDates(this._endRangeSelectedDate,false);else if(this._isToDateOpened)this._startRangeSelectedDate&&this._disableDates(this._startRangeSelectedDate,true)}for(var t in this._dateRows){var n=this._bindDateToRows(+t,this._dateRows[t]);this._dateRows[t].data("click-behaviour",n.isNextMonth);$(this._dateRows[t]).text("").text(n.day);this.selectionRule.single&&this._findSelectedDate(this._dateRows[t].data("date"),this._dateRows[t])}if(this.selectionRule.range)this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate);this._markToday(new Date);this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.briefDate)}else{if(this.view.display===this._displaySet.months){this._updateMonths();this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearName)}else if(this.view.display===this._displaySet.years){this._updateYears();this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearsRange)}}},_markToday:function(e){if(this.modules.today){e=e||this.currentDate;this._todayNode&&this._todayNode.removeClass(this.className._inner.todayInGrid).removeClass(this.className.todayBox);for(var t in this._dateRows){if(this._dateEqualsTo(this._dateRows[t].data("date"),e)){this._todayNode=this._dateRows[t];$(this._dateRows[t]).addClass(this.className._inner.todayInGrid).addClass(this.className.todayBox)}}}},_findSelectedDate:function(e,t){if(this._selectedDate&&this._dateEqualsTo(e,this._selectedDate)){this._selectedDateNode=t;this._addClassToSelectedDate(t)}},_bindDateToRows:function(e,t){var n=this;var r=new Date(this.currentDate.getTime());t.removeClass(this.className._inner.notNotable);var i=this._numberOfDaysInMonth(r);var s=this._currentDateExpose(r);var o=false;if(e>=s.firstDay&&e<i.nowMonthDays+s.firstDay){e=e-s.firstDay+1;o="not-avail";if(r.getDate()==e-1&&r.getHours()==0&&s.month==2){r=new Date(s.year,s.month,s.date+1,2)}else r.setDate(e)}else if(e<s.firstDay){var u=i.prevMonthDays-(s.firstDay-e-1);r.setMonth(r.getMonth()-1);r.setDate(u);t.addClass(this.className._inner.notNotable);e=u}else if(e>=i.nowMonthDays+s.firstDay){var a=e+1-(s.firstDay+i.nowMonthDays);r.setMonth(r.getMonth()+1);r.setDate(a);t.addClass(this.className._inner.notNotable);o=true;e=a}t.data("date",r);this._checkDisabling(r,t);return{day:e,isNextMonth:o}},_currentDateExpose:function(e){var t=new Date(e.getTime());t.setDate(1);return{firstDay:t.getDay(),date:e.getDate(),day:e.getDay(),month:e.getMonth(),year:e.getFullYear()}},_numberOfDaysInMonth:function(e){var t=e.getMonth();var n=e.getFullYear();return{prevMonthDays:this._getNumberOfDays(t-1<0?11:t-1,t-1<0?n-1:n),nowMonthDays:this._getNumberOfDays(t,n),nextMonthDays:this._getNumberOfDays(t+1>11?1:t,t+1>11?n+1:n)}},_getNumberOfDays:function(t,n){if(/8|3|5|10/.test(t))return 30;if(t!=1)return 31;if(n%4==0&&n%100!=0||n%400==0)return 29;return 28},_dateFormatting:function(e){var t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear();var i=this.dateFormat.format[0]=="NM"||this.dateFormat.format[1]=="NM"||this.dateFormat.format[2]=="NM";var s={DD:+t>=10||i?+t:"0"+t,MM:n>=10?n:"0"+n,YYYY:r,YY:String(r).substr(2),NM:this.monthsFull[+n-1]};var o=this.dateFormat.separator;var u="";this.forEach(this.dateFormat.format,function(e,t){s[t]&&(u+=s[t]+(e<2?o:""))},this);return u},_disableDates:function(e,t){var n=this._interpretRule(e,e);for(var r in this._dateRows){var i=this._dateRows[r];var s=i.data("date");this._removeDisableClass(i);i.data("disabled",false);var o=this._currentDateExpose(s);if(this[t?"_isLessThan":"_isBiggerThan"](o,n,true)){this._addDisableClass(i);i.data("disabled",true)}}},_backToNormalDisableRule:function(){for(var e in this._dateRows){var t=this._dateRows[e].data("date");this._checkDisabling(t,this._dateRows[e])}},_resetRules:function(e){if(e==="BOTH"){delete this._disableDateMap[this._lastIndexOfFromDate];delete this._disableDateMap[this._lastIndexOfToDate]}else{if(e){delete this._disableDateMap[this._lastIndexOfFromDate]}else{delete this._disableDateMap[this._lastIndexOfToDate]}}},_addRule:function(e,t,n){var r=this._interpretRule(e,t);if(r){this._resetRules(n);this._disableDateMap.unshift(r);var i=0;if(n){this._lastIndexOfToDate===0&&(this._lastIndexOfToDate=1);this._lastIndexOfFromDate=i}else{this._lastIndexOfFromDate===0&&(this._lastIndexOfFromDate=1);this._lastIndexOfToDate=i}}},_disablingRuleEngine:function(){for(var e in this.disablingRules){var t=this.disablingRules[e];var n=t.from;var r=t.to;if(isNaN(Date.parse(t.from))){if(!this._isInRuleCharset(n))return}else n=new Date(n);if(isNaN(Date.parse(t.to))){if(!r instanceof Array&&!r in this._rulesCharacterSet)return}else r=new Date(t.to);var i=this._interpretRule(t.from,t.to);i&&this._disableDateMap.push(i)}},_interpretRule:function(e,t){var n=!isNaN(Date.parse(e))||e instanceof Date;var r=!isNaN(Date.parse(t))||t instanceof Date;var i=this._isArray(e);var s=this._isArray(t);var o=this._isString(e);var u=this._isString(t);var a={fromDate:null,toDate:null,fromMonth:null,toMonth:null,fromYear:null,toYear:null};var f;var l;if(n&&r){f=this._currentDateExpose(new Date(e));l=this._currentDateExpose(new Date(t))}else{f=n?this._currentDateExpose(new Date(e)):this._giveMeRules(e);l=r?this._currentDateExpose(new Date(t)):this._giveMeRules(t)}a.fromDate=f.date;a.fromMonth=f.month;a.fromYear=f.year;a.toDate=l.date;a.toMonth=l.month;a.toYear=l.year;return a},_giveMeRules:function(e){var t={};if(e instanceof Array){t.date=e[2];t.month=isNaN(+e[1])?e[1]:+e[1]-1;t.year=e[0]}typeof e==="string"&&(t.date=t.month=t.year=e);return t},_isInRuleCharset:function(e){if(!e instanceof Array)return false;var t=false;for(var n in e)if(e[n]in this._rulesCharacterSet)t=true;return t},_isMatchToStringRule:function(e,t){var n=this;var r={">":this._isBiggerThan,"<":this._isLessThan,"*":function(r,i){if(n._isBiggerThan(e,t,true)||t.fromYear==="*")if(i.toYear==="*"){if(i.toMonth==="*"){if(i.toDate==="*")return true;else return r.date==i.toDate}else{if(i.toDate==="*")return r.month==i.toMonth;else return r.month==i.toMonth&&r.date==i.toDate}}else{if(i.toMonth==="*"){if(i.toDate==="*"){return r.year==i.toYear}else return r.year==i.toYear&&r.date==i.toDate}else{if(i.toDate==="*"){return r.year==i.toYear&&r.month==i.toMonth}else return r.year==i.toYear&&r.month==i.toMonth&&r.date==i.toDate}}}};for(var i in t){if(t[i]===">"||t[i]==="<")return r[t.toDate](e,t,true);if(t[i]==="*")return r[t[i]](e,t)}},_isMatchingToDisableRule:function(e){var t=this._currentDateExpose(e);var n=false;for(var r in this._disableDateMap){var i=this._disableDateMap[r];i&&(n=this._isInRuleCharset(i)?this._isMatchToStringRule(t,i):this._isBiggerThan(t,i,true)&&this._isLessThan(t,i,false));if(n)return n}return n},_checkDisabling:function(e,t){if(this._isMatchingToDisableRule(e)){t.data("disabled",true);this._addDisableClass(t)}else{t.data("disabled",false);this._removeDisableClass(t)}},_checkForRangeDisable:function(e,t,n){if(e&&t){var r=new Date(t.getTime());var i=new Date(e.getTime());n?r.setDate(r.getDate()-1):i.setDate(i.getDate()+1);var s=this._getRangeDates(i,r);for(var o in s){if(this._isMatchingToDisableRule(s[o]))return true}return false}return false},_isBiggerThan:function(e,t,n){var r=n?"from":"to";if(e.year>t[r+"Year"])return true;if(e.year==t[r+"Year"]&&e.month>t[r+"Month"])return true;return e.date>=t[r+"Date"]&&t[r+"Year"]==e.year&&t[r+"Month"]==e.month},_isLessThan:function(e,t,n){var r=n?"from":"to";if(e.year<t[r+"Year"])return true;if(e.year==t[r+"Year"]&&e.month<t[r+"Month"])return true;return e.date<=t[r+"Date"]&&t[r+"Year"]==e.year&&t[r+"Month"]==e.month},_isEqual:function(e,t,n){var r=n?"from":"to";return e.date==t[r+"Date"]&&t[r+"Year"]==e.year&&t[r+"Month"]==e.month},_enhanceLibFunctions:function(){this.forEach=function(e,t,n){$.each(e,function(e,r){t.call(n?n:this,e,r)})}},_domGenerator:function(e,t,n,r,i){var s=$(e.indexOf("<")===-1?"<"+e+">":e);return s.attr(t)[s[0].value?"val":"text"](r)[n?i?"prependTo":"appendTo":"andSelf"](n?n:undefined)},_addClass:function(){var e="";var t=arguments;this.forEach(arguments,function(n,r){e+=r+(n!==t.length-1&&t.length!==1?" ":"")},this);return e},_dynamicsGeometry:function(e){var t=$(window).outerHeight();var n=$(window).outerWidth();var r=$(e)[this.view.alwaysVisible?"position":"offset"]().top;var i=$(e)[this.view.alwaysVisible?"position":"offset"]().left;var s=$(e).outerHeight();var o=$(e).outerWidth();return{height:s,width:o,x:i,y:r,winHeight:t,winWidth:n}},_getDecisionOnEvents:function(){var e=this;this.on(this.events.hide,function(t){(e._selectedDate||e._startRangeSelectedDate)&&e._updateDateMatricesExactDate(e._selectedDate||e._startRangeSelectedDate,true);e._markToday(new Date)})},_rangeStatesManager:function(e){this._isToDateOpened=false;this._isFromDateOpened=true;if(e&&e.currentTarget===this._dateInputToNode[0]){this._isToDateOpened=true;this._isFromDateOpened=false;this._resetRules(false);this._startRangeSelectedDate&&this._addRule(this._startRangeSelectedDate,"<",true)}else{delete this._disableDateMap[this._lastIndexOfFromDate];this._endRangeSelectedDate&&this._addRule(this._endRangeSelectedDate,">",false)}this._backToNormalDisableRule();this._positionThisNodePlease(e&&this.selectionRule.range&&e.currentTarget===this._dateInputToNode[0]?this._dateInputToNode[0]:this.dateInputNode)},_increaseUnity:function(e){if(this.view.display===this._displaySet.days)this._updateDateMatrices(e?-1:1,this._monthUnit);else if(this.view.display===this._displaySet.months)this._updateDateMatrices(e?-1:1,this._yearUnit);else if(this.view.display===this._displaySet.years)this._updateDateMatrices(e?-12:12,this._yearUnit)},_setAppropriateDate:function(e,t){var n=new Date;n.setMonth(t);if(t){n.setFullYear(this.currentDate.getFullYear());n.setMonth(e)}else{n.setFullYear(e);n.setMonth(1)}n.setDate(1);return n},_closeIfFill:function(){if(this._dateInputToNode.val()&&this.dateInputNode.val()){!this.view.alwaysVisible&&this.hide();return this.view.alwaysVisible}return true},_getYearsRange:function(e){var t=e/12;var n=Math.floor(t)*12+1;var r=[];r.push(n);for(var i=1;i<=11;i++){r.push(n+i)}return r},_ExpandOrCollapse:function(e,t){var n=this;var r={1:function(){n._currentBriefDateSet(n._currentIndicator,n._briefDateScope.briefDate);n.view.display=n._displaySet.days},2:function(){n._currentBriefDateSet(n._currentIndicator,n._briefDateScope.yearName);n.view.display=n._displaySet.months},3:function(){n._currentBriefDateSet(n._currentIndicator,n._briefDateScope.yearsRange);n.view.display=n._displaySet.years}};var i={days:1,months:2,years:3,yearsRange:4};var s=e?r[i[this.view.display]+1]:r[i[this.view.display]-1];if(s){this.currentDate=t?new Date(t.getTime()):this.currentDate;s();this._createDateMatrices()}},_jumpToDateFromInput:function(e){var t=e.val();if(t){var n=e.val().split("/");var r=new Date;if(n.length===1){this.view.display=this._displaySet.years;r.setFullYear(n[0])}else if(n.length===2){this.view.display=this._displaySet.months;r.setFullYear(n[0]);r.setMonth(n[1])}else if(n.length===3){this.view.display=this._displaySet.days;r.setFullYear(n[0]);r.setMonth(n[1]);r.setDate(n[2])}this.currentDate=new Date(r.getTime());this._createDateMatrices(r)}},_dateEqualsTo:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},_getRangeDates:function(e,t){var n=[];var r=e;while(r<=t){n.push(new Date(r));r=this._addDays(r,1)}return n},_addDays:function(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()+t);return n},_addClassToSelectedDate:function(e){e.addClass(this.className.selected+" "+this.className._inner.selectedDate)},_removeClassFromSelectedDate:function(e){e.removeClass(this.className.selected+" "+this.className._inner.selectedDate)},_removeDisableClass:function(e){e.removeClass(this.className.disabled+" "+this.className._inner.disableDate)},_addDisableClass:function(e){e.addClass(this.className.disabled+" "+this.className._inner.disableDate)},_addClassToRange:function(e,t){if(e&&t)var n=this._interpretRule(e,t);for(var r in this._dateRows){var i=$(this._dateRows[r]);var s=i.data("date");this._removeClassFromSelectedDate(i);if(e&&t){i.removeClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode);var o=this._currentDateExpose(s);if(this._isEqual(o,n,true)||this._isEqual(o,n,false)){this._addClassToSelectedDate(i)}else if(this._isBiggerThan(o,n,true)&&this._isLessThan(o,n,false)){i.addClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode)}}else if(e){if(this._dateEqualsTo(this._startRangeSelectedDate,s))this._addClassToSelectedDate(i)}else if(t){if(this._dateEqualsTo(this._endRangeSelectedDate,s))this._addClassToSelectedDate(i)}}},_removeClassFromRange:function(){for(var e in this._dateRows)this._dateRows[e].removeClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode)},_notifySubscribers:function(e,t){var n=this._topicMap[e];if(n){this.forEach(n,function(e,n){n.func.call(n.scope,t)},this)}},_isDate:function(e){return e instanceof Date},_isArray:function(e){return e instanceof Array},_isString:function(e){return typeof e==="string"},on:function(e,t,n){if(e&&typeof e==="string"&&t){!this._topicMap[e]&&(this._topicMap[e]=[]);this._topicMap[e].push({func:t,scope:n?n:this._calendarMainNode})}},show:function(e){this._calendarMainNode.css("display","");this._isHide=false;!this.view.alwaysVisible&&this._notifySubscribers(this.events.show);this.selectionRule.range?this._rangeStatesManager(e):this._positionThisNodePlease(this.dateInputNode)},hide:function(){this._calendarMainNode.css("display","none");this._isHide=true;this._notifySubscribers(this.events.hide)},today:function(){this.currentDate=new Date;this._updateDateMatricesExactDate(self.currentDate)},reset:function(){if(this.selectionRule.range){(this._startRangeSelectedNode||this._endRangeSelectedNode)&&this._removeClassFromSelectedDate(this[this._startRangeSelectedNode?"_startRangeSelectedNode":"_endRangeSelectedNode"].add(this._endRangeSelectedNode));this._resetRules("BOTH");delete this._disableDateMap[this._lastIndexOfFromDate];delete this._disableDateMap[this._lastIndexOfToDate];this._endRangeSelectedDate=this._endRangeSelectedNode=this._startRangeSelectedDate=this._startRangeSelectedNode=this._lastIndexOfFromDate=this._lastIndexOfToDate=this._endRangeSelectedDateBk=this._startRangeSelectedDateBk=null;this._updateDateMatricesCommon();this._removeClassFromRange()}else{this._removeClassFromSelectedDate(this._selectedDateNode);this._selectedDateNode=this._selectedDate=null}this.dateInputNode.add(this._dateInputToNode).val("")},setDate:function(e){if(!isNaN(Date.parse(e)))this._updateDateMatricesExactDate(this._isDate(e)?e:new Date(Date.parse(e)))},setPos:function(e,t){this._positionThisNodePlease(e,t)},isHide:function(){return this._isHide},isDisable:function(e){return!isNaN(Date.parse(e))?this._isMatchingToDisableRule(new Date(Date.parse(e))):e},getPickerNodes:function(){return this.dateInputNode.add(this._dateInputToNode)},getSelectedStartDate:function(){return this._startRangeSelectedDate},getSelectedEndDate:function(){return this._endRangeSelectedDate},getSelectedDate:function(){return this._selectedDate},getCurrentDate:function(){return this.currentDate}};var beatPickerIncrementalId=0;initializeBitCal=function(){var e=$("*").filter(function(){return $(this).data("beatpicker")});$(e).each(function(){var e=$(this);var t={dateInputNode:e};$.extend(true,t,_interpretExtraOptions(e),_interpretPosition(e),_interpretDisableRules(e),_interpretRange(e),_interpretDateFormat(e),_interpretDisablingModule(e));_initialization(e,t)})};_initialization=function(e,t){var n=e.data("beatpicker-id");if(n)window[n]=new BeatPicker(t);else{n="beatpicker-"+beatPickerIncrementalId++;window[n]=new BeatPicker(t);e.attr("data-beatpicker-id",n)}};_interpretDisableRules=function(e){var t=e.data("beatpicker-disable");if(!t)return{};var n=[];t=t.replace(/\s+/g,"");var r=t.split("}");r=r.filter(function(e){return e!==""});for(var i in r){var s=r[i]+="}";if(s.indexOf(",")===0)s=s.substr(1);n.push(_parseJsonEngine(s,["from","to"]))}return{disablingRules:n}};_interpretPosition=function(e){var t=e.data("beatpicker-position");if(!t)return{};return{view:{position:_parseJsonEngine(t,[])}}};_interpretRange=function(e){var t=e.data("beatpicker-range");if(t===undefined)return{};t=String(t);var n,r;t=t.replace(/\s+/g,"");var i=t.split(",");n=i[0]==="true";r=i[1]==="true";return{selectionRule:{range:n,rangeDisableSelect:r,single:!n}}};_interpretDateFormat=function(e){var t=e.data("beatpicker-format");if(!t)return{};t=t.replace(/\s+/g,"");var n=t.indexOf("]");var r=t.substr(0,n+1);var i=t.substr(n+2,t.length);return{dateFormat:$.extend({format:_parseJsonEngine(r,[])},i?_parseJsonEngine("{"+i+"}",["separator"]):{separator:"-"})}};_interpretExtraOptions=function(e){var t=e.data("beatpicker-extra");if(!t)return null;if(!window[t])return null;return window[t]};_interpretDisablingModule=function(e){var t=e.data("beatpicker-module");if(!t)return;var n;t=t.replace(/\s+/g,"");n=t.split(",");var r={modules:{}};for(var i in n){var s=n[i];r.modules[s]=false}return r};_parseJsonEngine=function(e,t){for(var n in t){e=e.replace(t[n],'"'+t[n]+'"')}return typeof e==="string"?JSON.parse(e.replace(/'/g,'"')):e};try{$(document).ready(function(){initializeBitCal()})}catch(e){if(module)module.exports=BeatPicker.prototype}